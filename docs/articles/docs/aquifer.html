<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geoestadistica no parametrica con el paquete *npsp* â€¢ npsp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Geoestadistica no parametrica con el paquete *npsp*">
<meta property="og:description" content="Conceptos bÃ¡sicos y primeros pasos con el paquete npsp.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">npsp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7-14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../articles/npsp.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/aquifer.html">Geoestadistica no parametrica con el paquete *npsp*</a>
    </li>
    <li>
      <a href="../../articles/docs/Introduccion.html"> Introduccion a la Geoestadistica con R</a>
    </li>
    <li>
      <a href="../../articles/krigstat.html">Kriging with gstat</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rubenfcasal/npsp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Geoestadistica no parametrica con el paquete
<em>npsp</em>
</h1>
                        <h4 data-toc-skip class="author">Ruben
Fernandez-Casal (<a href="mailto:ruben.fcasal@udc.es" class="email">ruben.fcasal@udc.es</a>)</h4>
            
            <h4 data-toc-skip class="date">npsp 0.7.14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rubenfcasal/npsp/blob/HEAD/vignettes/docs/aquifer.Rmd" class="external-link"><code>vignettes/docs/aquifer.Rmd</code></a></small>
      <div class="hidden name"><code>aquifer.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rubenfcasal.github.io/npsp/">npsp</a></span><span class="op">)</span></span></code></pre></div>
<pre><code> Package npsp: Nonparametric Spatial Statistics,
 version 0.7-14 (built on 2024-07-09).
 Copyright (C) R. Fernandez-Casal 2012-2024.
 Type `help(npsp)` for an overview of the package or
 visit https://rubenfcasal.github.io/npsp.</code></pre>
<div class="section level2">
<h2 id="geoestadÃ­stica-no-paramÃ©trica">GeoestadÃ­stica no paramÃ©trica<a class="anchor" aria-label="anchor" href="#geoestad%C3%ADstica-no-param%C3%A9trica"></a>
</h2>
<p>Nos centraremos en el caso de procesos espaciales
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>ğ±</mi><mo>âˆˆ</mo><mi>D</mi><mo>âŠ‚</mo><msup><mi>â„</mi><mi>d</mi></msup><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\lbrace
Y(\mathbf{x}), \mathbf{x}  \in D\subset \mathbb{R}^{d}
\right\rbrace</annotation></semantics></math>, con dominio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
continuo fijo: proceso geoestadÃ­stico.</p>
<ul>
<li>El objetivo en el futuro es considerar procesos puntuales marcados:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
es un proceso puntual en
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>â„</mi><mi>d</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{R}^{d}.</annotation></semantics></math>
</li>
</ul>
<p>Normalmente sÃ³lo se observa un conjunto de valores
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{  y(\mathbf{x}_{1}),\ldots,y(\mathbf{x}_{n})\right\}</annotation></semantics></math>
(<strong>realizaciÃ³n parcial</strong>).</p>
<div class="section level3">
<h3 id="ejemplo">Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo"></a>
</h3>
<p>Se utilizarÃ¡ como ejemplo el conjunto de datos <a href="https://rubenfcasal.github.io/npsp/reference/aquifer.html"><code>aquifer</code></a>:
nivel del agua subterrÃ¡nea en el acuÃ­fero Wolfcamp.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">aquifer</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   85 obs. of  3 variables:
 $ lon : num  42.78 -27.4 -1.16 -18.62 96.47 ...
 $ lat : num  127.6 90.8 84.9 76.5 64.6 ...
 $ head: num  1464 2553 2158 2455 1756 ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#   Scatter plot with a color scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">aquifer</span>, <span class="fu"><a href="../../reference/spoints.html">spoints</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">head</span>, main <span class="op">=</span> <span class="st">"Wolfcamp aquifer data"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="modelo-general">Modelo general<a class="anchor" aria-label="anchor" href="#modelo-general"></a>
</h3>
<p>Se supone que el proceso se descompone en <em>variabilidad de gran
escala</em> y <em>variabilidad de pequeÃ±a escala</em>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Î¼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">Y(\mathbf{x})=\mu(\mathbf{x})+\varepsilon(\mathbf{x}),</annotation></semantics></math>
donde:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu(\cdot)</annotation></semantics></math>
es la tendencia (funciÃ³n determinÃ­stica).</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\varepsilon(\cdot)</annotation></semantics></math>
es un proceso de error estacionario de segundo orden, de media cero y
covariograma:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>C</mi><mi>o</mi><mi>v</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo>+</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C(\mathbf{u}) = Cov(\varepsilon(\mathbf{x}),
\varepsilon(\mathbf{x}+\mathbf{u} ))</annotation></semantics></math>
(varianza
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo>=</mo><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>ğŸ</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma^2 = C(\mathbf{0})</annotation></semantics></math>).</p></li>
</ul>
<p>La dependencia espacial se modela normalmente a travÃ©s del
variograma:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>Î³</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo>+</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">2\gamma(\mathbf{u}) = Var(\varepsilon \left( \mathbf{x}\right)
-\varepsilon \left(\mathbf{x}+\mathbf{u}\right) ),</annotation></semantics></math>
verificando
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma(\mathbf{u}) = C(0) - C(\mathbf{u})</annotation></semantics></math>.</p>
<p>Se emplearÃ¡ un modelo <strong>no paramÃ©trico</strong>: no se supone
ninguna forma concreta para
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi mathvariant="bold">â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu(\mathbf{\cdot})</annotation></semantics></math>
y
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi mathvariant="bold">â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma(\mathbf{\cdot})</annotation></semantics></math>
(funciones suaves).</p>
<ul>
<li><p>Evitan problemas debidos a una mala especificaciÃ³n del
modelo.</p></li>
<li><p>MÃ¡s fÃ¡ciles de automatizar.</p></li>
<li><p>Resultan tambiÃ©n de utilidad en inferencia paramÃ©trica.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="ejemplo-1">Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo-1"></a>
</h3>
<p>Con el conjunto de datos de ejemplo puede ser preferible emplear
mÃ©todos paramÃ©tricos. El tamaÃ±o muestral es pequeÃ±o y un modelo lineal
para la tendencia parece ser adecuado.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">aquifer</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>      <span class="co"># coordenadas espaciales</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">aquifer</span><span class="op">$</span><span class="va">head</span><span class="op">/</span><span class="fl">100</span>   <span class="co"># respuesta (en cientos de pies)</span></span>
<span><span class="fu"><a href="../../reference/scattersplot.html">scattersplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, main <span class="op">=</span> <span class="st">"Wolfcamp aquifer data"</span>, xlab <span class="op">=</span> <span class="st">'lon'</span>, ylab <span class="op">=</span><span class="st">'lat'</span>, </span>
<span>             zlab <span class="op">=</span> <span class="st">'piezometric-head'</span>, col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">jet.colors</a></span><span class="op">(</span><span class="fl">128</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="inferencia-no-paramÃ©trica-en-procesos-geoestadÃ­sticos">Inferencia (no paramÃ©trica) en procesos geoestadÃ­sticos<a class="anchor" aria-label="anchor" href="#inferencia-no-param%C3%A9trica-en-procesos-geoestad%C3%ADsticos"></a>
</h3>
<p>A partir de los valores observados
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ˜</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{Y}=(Y(\mathbf{x}_1),\ldots,Y(\mathbf{x}_n))^{t}</annotation></semantics></math>
puede interesar:</p>
<ul>
<li><p>Obtener predicciones (kriging):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Y</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{Y}(\mathbf{x}_0)</annotation></semantics></math>.</p></li>
<li><p>Realizar inferencias (estimaciÃ³n, contrastes) sobre las
componentes del modelo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\mu}(\cdot)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î³</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\gamma}(\cdot)</annotation></semantics></math>.</p></li>
<li><p>ObtenciÃ³n de mapas de riesgo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰¥</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P({Y}(\mathbf{x}_0)\geq c)</annotation></semantics></math></p></li>
<li><p>â€¦</p></li>
</ul>
<p>Aunque hay una gran cantidad de paquetes de R con herramientas de
utilidad en geoestadÃ­stica (<code>geoR</code>, <code>gstat</code>,
<code>fields</code>, â€¦) o en estadÃ­stica no paramÃ©trica
(<code>mgcv</code>, <code>KernSmooth</code>, <code>sm</code>, â€¦), la
mayorÃ­a presentan una funcionalidad muy limitada para estadÃ­stica
espacial no paramÃ©trica o resulta difÃ­cil emplearlos para implementar
nuevos mÃ©todos (ademÃ¡s de otras limitaciones, como su eficiencia
computacional o el nÃºmero de dimensiones que soportan). Por este motivo
se decidiÃ³ desarrollar el paquete <a href="https://rubenfcasal.github.io/npsp"><code>npsp</code></a>:</p>
<ul>
<li><p>CRAN: <a href="https://cran.r-project.org/package=npsp" class="external-link uri">https://cran.r-project.org/package=npsp</a></p></li>
<li><p>Github: <a href="http://github.com/rubenfcasal/npsp" class="external-link uri">http://github.com/rubenfcasal/npsp</a></p></li>
</ul>
<p>La idea serÃ­a:</p>
<ul>
<li><p>Proporcionar un entorno homogÃ©neo para la estimaciÃ³n polinÃ³mica
lÃ³cal multidimensional (tendencia, variograma, densidad, â€¦),
especialmente para el caso de procesos espaciales (y
espacio-temporales).</p></li>
<li><p>Trata de minimizar el tiempo de computaciÃ³n y los requerimientos
de memoria.</p></li>
<li><p>Emplear clases y mÃ©todos S3 sencillos (que permitan interactuar
con las clases S4 del paquete <code>sp</code> y las nuevas S3 del
paquete <code>sf</code>; ver <code>npsp/inst/</code> <a href="https://github.com/rubenfcasal/npsp/blob/master/inst/locpol_classes.pdf" class="external-link">locpol_classes.pdf</a>).</p></li>
<li><p>Robusto y que facilite la implementaciÃ³n de nuevos
mÃ©todos.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="binning-lineal">Binning lineal<a class="anchor" aria-label="anchor" href="#binning-lineal"></a>
</h2>
<p>Para acelerar los cÃ¡lculos se emplea binning (WARPing; e.g.Â Wand and
Jones, 1995):</p>
<ul>
<li>datos
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>â‡’</mo><annotation encoding="application/x-tex">\Longrightarrow</annotation></semantics></math>
discretizaciÃ³n
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>â‡’</mo><annotation encoding="application/x-tex">\Longrightarrow</annotation></semantics></math>
suavizado
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>â‡’</mo><annotation encoding="application/x-tex">\Longrightarrow</annotation></semantics></math>
interpolaciÃ³n</li>
</ul>
<p>Normalmente el resultado final del anÃ¡lisis es una rejilla y el
Ãºltimo paso sÃ³lo interesa en cÃ¡lculos intermedios (e.g.Â obtenciÃ³n de
residuos).</p>
<div class="section level3">
<h3 id="discretizaciÃ³n">DiscretizaciÃ³n<a class="anchor" aria-label="anchor" href="#discretizaci%C3%B3n"></a>
</h3>
<p>En la estimaciÃ³n polinÃ³mica local se emplea binning lineal.</p>
<ul>
<li>Wand M.P. and Jones M.C. (1995) <em>Kernel Smoothing</em>. Chapman
and Hall.</li>
</ul>
<p>Las principales funciones son:</p>
<ul>
<li><p>Tendencia (y densidad): <a href="https://rubenfcasal.github.io/npsp/reference/binning.html"><code>binning</code></a>.</p></li>
<li><p>Variograma: <a href="https://rubenfcasal.github.io/npsp/reference/svar.bin.html"><code>svar.bin</code></a></p></li>
</ul>
<p>Normalmente se emplearan dos rejillas, una de baja resoluciÃ³n para
acelerar los cÃ¡lculos durante el proceso de modelado (selecciÃ³n de la
ventana, cÃ¡lculos intermedios, â€¦) y otra con la resoluciÃ³n deseada para
obtener los resultados finales.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>reset<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>CPU time has been initialized.</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/binning.html">binning</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, nbin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41</span>,<span class="fl">41</span><span class="op">)</span>, set.NA <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../../reference/simage.html">simage</a></span><span class="op">(</span><span class="va">bin</span>, main <span class="op">=</span> <span class="st">'Binning averages'</span><span class="op">)</span></span>
<span><span class="co"># Data points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">bin</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">'darkgray'</span><span class="op">)</span></span>
<span><span class="co"># Binning grid</span></span>
<span><span class="va">coordvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/coordvalues.html">coordvalues</a></span><span class="op">(</span><span class="va">bin</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">coordvs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">coordvs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/binning-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.00    0.00    0.01 </code></pre>
</div>
<div class="section level3">
<h3 id="interpolaciÃ³n">InterpolaciÃ³n<a class="anchor" aria-label="anchor" href="#interpolaci%C3%B3n"></a>
</h3>
<p>En el paquete se emplea interpolaciÃ³n lineal (algoritmo anÃ¡logo al
binning lineal). MÃ©todos:</p>
<ul>
<li>
<a href="https://rubenfcasal.github.io/npsp/reference/interp.html"><code>interp</code></a>
y <a href="https://rubenfcasal.github.io/npsp/reference/interp.html"><code>predict</code></a>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="estimaciÃ³n-de-la-densidad">EstimaciÃ³n de la densidad<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-densidad"></a>
</h2>
<p>La estimaciÃ³n de la densidad estÃ¡ implementada como un caso
particular de regresiÃ³n (se suavizan los pesos binning reescalados):</p>
<ul>
<li>
<a href="https://rubenfcasal.github.io/npsp/reference/np.den.html"><code>np.den</code></a>.</li>
</ul>
<p>Por defecto emplea el estimador lineal local (establecer
<code>degree = 0</code> para Nadaraya-Watson).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">den</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/np.den.html">np.den</a></span><span class="op">(</span><span class="va">bin</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="co"># alternatively, set h = h.cv(as.bin.den(bin))$h</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">den</span>, main <span class="op">=</span> <span class="st">'Estimated log(density)'</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/np.den-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Se puede emplear por ejemplo para establecer una mÃ¡scara que filtre
las posiciones alejadas de los datos.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/mask.html">mask</a></span><span class="op">(</span><span class="va">bin</span>, mask <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">den</span><span class="op">$</span><span class="va">est</span><span class="op">)</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">14</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bin</span><span class="op">)</span></span></code></pre></div>
<pre><code>List of 5
 $ biny: num [1:41, 1:41] NA NA NA NA NA NA 35.1 35.1 NA NA ...
 $ binw: num [1:41, 1:41] 0 0 0 0 0 ...
 $ grid:List of 6
  ..$ nd      : int 2
  ..$ n       : int [1:2] 41 41
  ..$ min     : num [1:2] -145.24 9.41
  ..$ max     : num [1:2] 113 185
  ..$ lag     : num [1:2] 6.45 4.38
  ..$ dimnames: chr [1:2] "lon" "lat"
  ..- attr(*, "class")= chr "grid.par"
 $ data:List of 3
  ..$ x  : num [1:85, 1:2] 42.78 -27.4 -1.16 -18.62 96.47 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:85] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:2] "lon" "lat"
  ..$ y  : num [1:85] 14.6 25.5 21.6 24.6 17.6 ...
  ..$ med: num 20
 $ mask: logi [1:41, 1:41] TRUE TRUE TRUE TRUE TRUE TRUE ...
 - attr(*, "class")= chr [1:3] "bin.data" "bin.den" "data.grid"</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.07    0.00    0.47 </code></pre>
</div>
<div class="section level2">
<h2 id="estimaciÃ³n-de-la-tendencia">EstimaciÃ³n de la tendencia<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-tendencia"></a>
</h2>
<div class="section level3">
<h3 id="regresiÃ³n-polinÃ³mica-local">RegresiÃ³n polinÃ³mica local<a class="anchor" aria-label="anchor" href="#regresi%C3%B3n-polin%C3%B3mica-local"></a>
</h3>
<p>En el caso univariante, para cada
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>0</mn></msub><annotation encoding="application/x-tex">x_{0}</annotation></semantics></math>
se ajusta un polinomio:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>â‹¯</mi><mo>+</mo><msub><mi>Î²</mi><mi>p</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">\beta_{0}+\beta_{1}\left(x - x_{0}\right) + \cdots 
+ \beta_{p}\left( x-x_{0}\right)^{p}</annotation></semantics></math> por
mÃ­nimos cuadrados ponderados, con pesos
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>h</mi></mfrac><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><mi>h</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_{i} = \frac{1}{h}K\left(\frac{x-x_{0}}{h}\right)</annotation></semantics></math>.</p>
<ul>
<li><p>La estimaciÃ³n en
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>0</mn></msub><annotation encoding="application/x-tex">x_{0}</annotation></semantics></math>
es
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>h</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\hat{\mu}_{h}(x_{0})=\hat{\beta}_{0}</annotation></semantics></math>.</p></li>
<li><p>Adicionalmente:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msubsup><mi>Î¼</mi><mi>h</mi><mrow><mi>r</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>r</mi><mi>!</mi><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">\widehat{\mu_{h}^{r)}}(x_{0}) = r!\hat{\beta}_{r}</annotation></semantics></math>.</p></li>
</ul>
<p>Habitualmente se considera:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p=0</annotation></semantics></math>:
Estimador Nadaraya-Watson.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=1</annotation></semantics></math>:
Estimador lineal local.</p></li>
</ul>
<p>El caso multivariante es anÃ¡logo. La estimaciÃ³n lineal local
multivariante
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>ğ‡</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\hat{\mu}_{\mathbf{H}}(\mathbf{x})=\hat{\beta}_{0}</annotation></semantics></math>
se obtiene al minimizar:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>min</mo><mrow><msub><mi>Î²</mi><mn>0</mn></msub><mo>,</mo><msub><mi>ğ›ƒ</mi><mn>1</mn></msub></mrow></munder><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>âˆ’</mo><msubsup><mi>ğ›ƒ</mi><mn>1</mn><mi>t</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msub><mi>K</mi><mi>ğ‡</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\min_{\beta_{0},\boldsymbol{\beta}_{1}}\sum_{i=1}^{n}
\left( Y(\mathbf{x}_{i})-\beta_{0}-{\boldsymbol{\beta}}_{1}^{t}
(\mathbf{x}_{i}-\mathbf{x})\right)^{2}
K_{\mathbf{H}}(\mathbf{x}_{i}-\mathbf{x}),</annotation></semantics></math>
donde:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‡</mi><annotation encoding="application/x-tex">\mathbf{H}</annotation></semantics></math>
es la matriz de ventanas
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>Ã—</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">d\times d</annotation></semantics></math>
(simÃ©trica no singular).</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>ğ‡</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ‡</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K_{\mathbf{H}}(\mathbf{u})=\left\vert \mathbf{H}\right\vert
^{-1}K(\mathbf{H}^{-1}\mathbf{u})</annotation></semantics></math> y
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
nÃºcleo multivariante.</p></li>
</ul>
<p>ExplÃ­citamente:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>ğ‡</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>ğ</mi><mn>1</mn><mi>t</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ğ—</mi><mi>ğ±</mi><mi>t</mi></msubsup><msub><mi>ğ–</mi><mi>ğ±</mi></msub><msub><mi>ğ—</mi><mi>ğ±</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><msubsup><mi>ğ—</mi><mi>ğ±</mi><mi>t</mi></msubsup><msub><mi>ğ–</mi><mi>ğ±</mi></msub><mi>ğ˜</mi><mo>â‰¡</mo><msubsup><mi>s</mi><mi>ğ±</mi><mi>t</mi></msubsup><mi>ğ˜</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{\mu}_{\mathbf{H}}(\mathbf{x}) = \mathbf{e}_{1}^{t} \left(
\mathbf{X}_{\mathbf{x}}^{t} {\mathbf{W}}_{\mathbf{x}} 
\mathbf{X}_{\mathbf{x}} \right)^{-1} \mathbf{X}_{\mathbf{x}}^{t} 
{\mathbf{W}}_{\mathbf{x}}\mathbf{Y} \equiv {s}_{\mathbf{x}}^{t}\mathbf{Y},</annotation></semantics></math>
donde
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ</mi><mn>1</mn></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>â‹¯</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{e}_{1} = \left( 1, \cdots, 0\right)^{t}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ—</mi><mi>ğ±</mi></msub><annotation encoding="application/x-tex">\mathbf{X}_{\mathbf{x}}</annotation></semantics></math>
es la matriz con
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,(\mathbf{x}_{i}-\mathbf{x})^{t})</annotation></semantics></math>
en fila
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
y
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ–</mi><mi>ğ±</mi></msub><mo>=</mo><mrow><mi>ğš</mi><mi>ğš’</mi><mi>ğšŠ</mi><mi>ğš</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>ğ‡</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo>âˆ’</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>K</mi><mi>ğ‡</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>n</mi></msub><mo>âˆ’</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{W}_{\mathbf{x}} = \mathtt{diag} \left(
K_{\mathbf{H}}(\mathbf{x}_{1} - \mathbf{x}), ...,
K_{\mathbf{H}}(\mathbf{x}_{n}-\mathbf{x}) \right)</annotation></semantics></math>
es la matriz de pesos.</p>
<p>Se puede pensar que se obtiene aplicando un suavizado lineal a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>,</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{x}_i, Y(\mathbf{x}_i))</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><mrow><mi>ğ’</mi><mi>ğ˜</mi></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\mu}} = \mathbf{SY},</annotation></semantics></math>
siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ’</mi><annotation encoding="application/x-tex">\mathbf{S}</annotation></semantics></math>
la matriz de suavizado con
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ğ¬</mi><msub><mi>ğ±</mi><mi>i</mi></msub><mi>t</mi></msubsup><annotation encoding="application/x-tex">\mathbf{s}_{\mathbf{x}_{i}}^{t}</annotation></semantics></math>
en la fila
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="implementaciÃ³n-en-el-paquete-npsp">ImplementaciÃ³n en el paquete <code>npsp</code><a class="anchor" aria-label="anchor" href="#implementaci%C3%B3n-en-el-paquete-npsp"></a>
</h3>
<p>La estimaciÃ³n polinÃ³mica local estÃ¡ implementada en la funciÃ³n
genÃ©rica <a href="https://rubenfcasal.github.io/npsp/reference/locpol.html"><code>locpol</code></a>:</p>
<ul>
<li><p>Emplea una matriz de ventanas completa y un nÃºcleo triweight para
el cÃ¡lculo de los pesos.</p></li>
<li><p>Permite cÃ¡lcular eficientemente la matriz de suavizado
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ’</mi><annotation encoding="application/x-tex">\mathbf{S}</annotation></semantics></math>
(de utilidad en la estimaciÃ³n de la dependencia, en la selecciÃ³n de la
ventana, â€¦).</p></li>
<li><p>CÃ³digo <em>optimizado</em> para minimizar el tiempo de
computaciÃ³n y los requerimientos de memoria (especialmente para
validaciÃ³n cruzada, estimaciÃ³n del variograma, â€¦). Los cÃ¡lculos se
realizan en FORTRAN.</p></li>
<li><p>Para resolver el problema de regresiÃ³n lineal (local), se emplea
(<a href="https://github.com/rubenfcasal/npsp/blob/master/src/dgelsyr.f" class="external-link"><code>src/dgelsyr.f</code></a>)
una modificaciÃ³n de la rutina DGELSY de la librerÃ­a LAPACK (admite
matrices de rango deficiente).</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="ejemplo-2">Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo-2"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/locpol.html">locpol</a></span><span class="op">(</span><span class="va">bin</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>, hat.bin <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span><span class="co"># Perspective plot with a color scale</span></span>
<span><span class="fu"><a href="../../reference/spersp.html">spersp</a></span><span class="op">(</span><span class="va">lp</span>, main <span class="op">=</span> <span class="st">'Trend estimates'</span>, zlab <span class="op">=</span> <span class="st">'piezometric-head'</span>, theta <span class="op">=</span> <span class="fl">120</span><span class="op">)</span>   </span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
    0.0     0.0     0.2 </code></pre>
</div>
</div>
<div class="section level2">
<h2 id="estimaciÃ³n-del-variograma">EstimaciÃ³n del variograma<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-variograma"></a>
</h2>
<p>Al igual que en la geoestadÃ­stica paramÃ©trica tradicional, el
modelado de la dependencia se realiza a partir de los residuos:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">e(\mathbf{x}_{i})=Y(\mathbf{x}_{i})-\hat{\mu}(\mathbf{x}_{i}).</annotation></semantics></math>
Si la media se supone cte. (proceso estacionario) se trabaja
directamente con las observaciones (se sustituirÃ­a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">e(\mathbf{x}_{i})</annotation></semantics></math>
por
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y(\mathbf{x}_{i})</annotation></semantics></math>
en las expresiones).</p>
<p>La estimaciÃ³n se realiza en dos pasos, en primer lugar se obtiene una
estimaciÃ³n piloto del variograma y posteriormente se ajusta un modelo
vÃ¡lido.</p>
<div class="section level3">
<h3 id="estimaciÃ³n-piloto-del-variograma">EstimaciÃ³n piloto del variograma<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-piloto-del-variograma"></a>
</h3>
<p>En los mÃ©todos tradicionales se trata como un caso particular de
regresiÃ³n:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>E</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\gamma\left(  \mathbf{x}_{i}-\mathbf{x}_{j}\right)  =\frac{1}{2}E\left(
\varepsilon(\mathbf{x}_{i})-\varepsilon(\mathbf{x}_{j})\right)^{2}</annotation></semantics></math>
con
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mfrac><mrow><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">N=\frac{n(n-1)}{2}</annotation></semantics></math>
observaciones:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo>,</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">{\left(\mathbf{x}_{i}-\mathbf{x}_{j},
(e(\mathbf{x}_{i})-e(\mathbf{x}_{j}))^2 / 2 \right)},</annotation></semantics></math>
asumiendo que la variabilidad de los residuos es (similar a) la de los
errores.</p>
<p>La estimaciÃ³n polinÃ³mico local
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î³</mi><mo accent="true">Ì‚</mo></mover><mi>ğ†</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\hat{\gamma}_{\mathbf{G}}(\mathbf{u}) = \hat{\beta}_{0}</annotation></semantics></math>
se obtendrÃ­a minimizando:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="right" style="text-align: right"><munder><mo>min</mo><mrow><msub><mi>Î²</mi><mn>0</mn></msub><mo>,</mo><msub><mi>ğ›ƒ</mi><mn>1</mn></msub><mo>,</mo><mi>â‹¯</mi></mrow></munder><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>âˆ’</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>âˆ’</mo><msubsup><mi>ğ›ƒ</mi><mn>1</mn><mi>t</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo>âˆ’</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>â‹¯</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>Ã—</mo></mtd><mtd columnalign="left" style="text-align: left"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>K</mi><mi>ğ†</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo>âˆ’</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"></mtd></mtr></mtable><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{aligned}
\min_{\beta_{0}, \boldsymbol{\beta}_{1}, \cdots}
\sum_{i=1}^{n}\left( \frac{1}{2} \left( e(\mathbf{x}_{i})-e(\mathbf{x}_{j})
\right)^{2} - \beta_{0} - {\boldsymbol{\beta}}_{1}^{t} (\mathbf{x}_{i} - 
\mathbf{x}_{j} - \mathbf{u}) - \cdots\right)  ^{2}\times &amp; \\
K_{\mathbf{G}}(\mathbf{x}_{i}-\mathbf{x}_{j}-\mathbf{u})  &amp;
\end{aligned},</annotation></semantics></math> siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ†</mi><annotation encoding="application/x-tex">\mathbf{G}</annotation></semantics></math>
la correspondiente matriz de ventanas.</p>
<p>Actualmente en el paquete <code>npsp</code> solo estÃ¡ implementado el
caso isotrÃ³pico:</p>
<ul>
<li><p><a href="https://rubenfcasal.github.io/npsp/reference/svar.bin.html"><code>svar.bin</code></a>:
estimador empÃ­rico con binning lineal.</p></li>
<li><p><a href="https://rubenfcasal.github.io/npsp/reference/np.svar.html"><code>np.svar</code></a>:
estimador polinÃ³mico local.</p></li>
</ul>
<p>Estas funciones son adecuadas para procesos estacionarios y se
podrÃ­an emplear en el caso no estacionario para estimar el variograma
residual (sesgado) calculando previamente los residuos.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lp.resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lp</span><span class="op">)</span></span>
<span><span class="va">esvar0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/np.svar.html">np.svariso</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">lp.resid</span>, nlags <span class="op">=</span> <span class="fl">50</span>, h <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">esvar0</span>, main <span class="op">=</span> <span class="st">"Nonparametric (residual) pilot semivariogram"</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.01    0.00    0.21 </code></pre>
</div>
<div class="section level3">
<h3 id="estimaciÃ³n-piloto-del-variograma-con-correcciÃ³n-de-sesgo">EstimaciÃ³n piloto del variograma con correcciÃ³n de sesgo<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-piloto-del-variograma-con-correcci%C3%B3n-de-sesgo"></a>
</h3>
<p>El uso directo de los residuos
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ›†</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><mi>ğ˜</mi><mo>âˆ’</mo><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>ğˆ</mi><mo mathvariant="bold">âˆ’</mo><mi>ğ’</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>ğ˜</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\hat{\varepsilon}} =
\mathbf{Y} - \hat{\boldsymbol{\mu}} = (\mathbf{I - S})\mathbf{Y}</annotation></semantics></math>
introduce un sesgo en la estimaciÃ³n del variograma, ya que su
variabilidad es distinta de la de los errores:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›†</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ğšº</mi><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover></msub><mo>=</mo><mi>ğšº</mi><mo>+</mo><mi>ğ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">Var(\boldsymbol{\hat{\varepsilon}}) = 
{\boldsymbol{\Sigma}}_{\hat{\varepsilon}}
= \boldsymbol{\Sigma} + \mathbf{B},</annotation></semantics></math>
siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ</mi><mo>=</mo><mi>ğ’</mi><mi>ğšº</mi><msup><mi>ğ’</mi><mi>t</mi></msup><mo>âˆ’</mo><mi>ğšº</mi><msup><mi>ğ’</mi><mi>t</mi></msup><mo>âˆ’</mo><mi>ğ’</mi><mi>ğšº</mi></mrow><annotation encoding="application/x-tex">\mathbf{B} = \mathbf{S} \boldsymbol{\Sigma} \mathbf{S}^{t}
- \boldsymbol{\Sigma} \mathbf{S}^{t} - \mathbf{S} \boldsymbol{\Sigma}</annotation></semantics></math>
la matriz de sesgos.</p>
<p>En tÃ©rminos del variograma:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>Îµ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub><mo>âˆ’</mo><mn>2</mn><msub><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">Var\left(\hat{\varepsilon}(\mathbf{x}_i) 
- \hat{\varepsilon}(\mathbf{x}_j) \right) =
Var\left(\varepsilon(\mathbf{x}_i) - \varepsilon(\mathbf{x}_j) \right)
+ b_{ii} + b_{jj} - 2 b_{ij}.</annotation></semantics></math> Este sesgo
es normalmente negativo y mayor en saltos grandes (ver p.e. Cressie,
1993, secciÃ³n 3.4.3). En Fernandez-Casal y Francisco-Fernandez (2013) se
propone un mÃ©todo iterativo para su correcciÃ³n. La funciÃ³n
<code>np.svariso.corr</code> implementa un algoritmo similar (totalmente
no paramÃ©trico). Comenzando con el estimador lineal local residual
anterior, en cada iteraciÃ³n
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
se actualizan las diferencias
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">(\hat{\varepsilon}(\mathbf{x}_i)- \hat{\varepsilon}(\mathbf{x}_j))^2</annotation></semantics></math>
reemplazÃ¡ndolas por:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>âˆ’</mo><msubsup><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>âˆ’</mo><msubsup><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>j</mi><mi>j</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><mn>2</mn><msubsup><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo></mrow><annotation encoding="application/x-tex">(\hat{\varepsilon}(\mathbf{x}_i)- \hat{\varepsilon}(\mathbf{x}_j))^2 
- \hat{b}_{ii}^{(k-1)} - \hat{b}_{jj}^{(k-1)} + 2 \hat{b}_{ij}^{(k-1)},</annotation></semantics></math>
siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\hat{\mathbf{B}}^{(k-1)}</annotation></semantics></math>
la aproximaciÃ³n del sesgo obtenida en la iteraciÃ³n anterior.</p>
<p>Ejemplo:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/np.svar.html">np.svariso.corr</a></span><span class="op">(</span><span class="va">lp</span>, nlags <span class="op">=</span> <span class="fl">50</span>, h <span class="op">=</span> <span class="fl">50</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/np.svariso.corr-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code>Iteration  2 :  1 
Iteration  3 :  0.1071746 
Iteration  4 :  0.07731208 
Iteration  5 :  0.06118289 
Iteration  6 :  0.05087295 
Iteration  7 :  0.04358588 </code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.02    0.00    0.28 </code></pre>
</div>
<div class="section level3">
<h3 id="ajuste-de-un-modelo-no-paramÃ©trico">Ajuste de un modelo no paramÃ©trico<a class="anchor" aria-label="anchor" href="#ajuste-de-un-modelo-no-param%C3%A9trico"></a>
</h3>
<p>Los estimadores piloto no verifican las propiedades de un variograma
(condicionalmente semidefinidos negativos) y no pueden ser usados en
predicciÃ³n espacial (kriging). Para resolver este problema se ajusta un
modelo vÃ¡lido.</p>
<p>La funciÃ³n <a href="https://rubenfcasal.github.io/npsp/reference/fitsvar.sb.iso.html"><code>fitsvar.sb.iso</code></a>
permite ajustar un modelo no paramÃ©trico de Shapiro-Botha. En el caso
isotrÃ³pico son de la forma:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">â€–</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">â€–</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î½</mi><mn>0</mn></msub><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>Îº</mi><mi>d</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">â€–</mo><mi>ğ®</mi><mo stretchy="true" form="postfix">â€–</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>z</mi><mi>k</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\gamma(\left\Vert \mathbf{u} \right\Vert ) = \nu_{0} - 
    \sum\limits_{k=1}^{K}\kappa_{d}(x_{k}\left\Vert \mathbf{u}\right\Vert )
    z_{k},</annotation></semantics></math> siendo:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Îº</mi><mi>d</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="false"><mn>2</mn><mi>x</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><mi>d</mi><mrow><mi>âˆ’</mi><mn>2</mn></mrow></mrow><mn>2</mn></mfrac></msup><mi>Î“</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="false"><mi>d</mi><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>J</mi><mfrac><mrow><mi>d</mi><mrow><mi>âˆ’</mi><mn>2</mn></mrow></mrow><mn>2</mn></mfrac></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\kappa_{d}(x) = \left( \tfrac{2}{x}\right)^{{\frac{d{-2}}{2}}}
\Gamma\left(  \tfrac{d}{2}\right)  J_{{\frac{d{-2}}{2}}}(x)</annotation></semantics></math>,
donde
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mi>p</mi></msub><annotation encoding="application/x-tex">J_p</annotation></semantics></math>
es la funciÃ³n de Bessel de orden
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>k</mi></msub><annotation encoding="application/x-tex">x_{k}</annotation></semantics></math>
nodos de discretizaciÃ³n (siguiendo la recomendaciÃ³n de Gorsich y Genton,
2004, se establecen reescalando los ceros de las funciones de Bessel
(ver <a href="https://rubenfcasal.github.io/npsp/reference/disc.sb.html"><code>disc.sb</code></a>).).</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>z</mi><mi>K</mi></msub><mo>,</mo><msub><mi>Î½</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msup><annotation encoding="application/x-tex">\left( z_{1}, ..., z_{K}, \nu_{0} \right)^{t}</annotation></semantics></math>
parÃ¡metros, verificando:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>k</mi></msub><mo>â‰¥</mo><mn>0</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> y </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>c</mi><mn>0</mn></msub><mo>=</mo><msub><mi>Î½</mi><mn>0</mn></msub><mo>âˆ’</mo><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>z</mi><mi>k</mi></msub><mo>â‰¥</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">z_{k} \geq0 \text{ y } 
c_{0} =  \nu_{0}-\sum\nolimits_{k=1}^{K}z_{k}\geq0.</annotation></semantics></math></p></li>
</ul>
<p>El ajuste por WLS a un conjunto de estimaciones piloto se puede
realizar fÃ¡cilmente mediante programaciÃ³n cuadrÃ¡tica (modificaciÃ³n de la
funciÃ³n <code>solve.QP</code> del paquete <code>quadprog</code> para
obtener la soluciÃ³n de problemas no estrictamente convexos).</p>
<p>Estos modelos son muy flexibles por lo que es habitual considerar una
dimensiÃ³n
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
mayor que la de los datos para obtener ajustes mÃ¡s suaves (empleando el
parÃ¡metro <code>dk</code>). En el lÃ­mite obtendrÃ­amos
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Îº</mi><mi>âˆ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰¡</mo><msup><mi>e</mi><mrow><mi>âˆ’</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></msup></mrow><annotation encoding="application/x-tex">\kappa_{\infty}(x)\equiv e^{-x^{2}}</annotation></semantics></math>,
que se corresponderÃ­a con un modelo vÃ¡lido en cualquier dimensiÃ³n (se
selecciona estableciendo<code>dk = 0</code>).</p>
<p>Ejemplo:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fitsvar.sb.iso.html">fitsvar.sb.iso</a></span><span class="op">(</span><span class="va">esvar</span>, dk <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">svm</span>, main <span class="op">=</span> <span class="st">"Nonparametric semivariogram and fitted model"</span><span class="op">)</span></span>
<span><span class="va">svm0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fitsvar.sb.iso.html">fitsvar.sb.iso</a></span><span class="op">(</span><span class="va">esvar0</span>, dk <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">svm0</span><span class="op">$</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">u</span>, <span class="va">fitted.sv</span>, lty <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
    0.0     0.0     0.2 </code></pre>
<p>Estos modelos son extensibles al caso anisotrÃ³pico (Fernandez-Casal
<em>et al</em>., 2003), adecuado para procesos espacio-temporales.</p>
</div>
</div>
<div class="section level2">
<h2 id="selecciÃ³n-de-las-ventanas">SelecciÃ³n de las ventanas<a class="anchor" aria-label="anchor" href="#selecci%C3%B3n-de-las-ventanas"></a>
</h2>
<p>La funciÃ³n genÃ©rica <a href="https://rubenfcasal.github.io/npsp/reference/h.cv.html"><code>h.cv</code></a>
permite seleccionar la ventana de una estimaciÃ³n polinÃ³mico local (de la
tendencia, densidad o variograma) usando criterios de validaciÃ³n cruzada
(CV), validaciÃ³n cruzada generalizada (GCV) o MASE (estÃ¡ndar y
modificados).</p>
<div class="section level3">
<h3 id="estimaciÃ³n-de-la-tendencia-1">EstimaciÃ³n de la tendencia<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-tendencia-1"></a>
</h3>
<p>Con los criterios de selecciÃ³n de la ventana diseÃ±ados para datos
independientes se tiende a infrasuavizar la estimaciÃ³n (e.g.Â Opsomer et
al, 2001):</p>
<ul>
<li><p>ValidaciÃ³n cruzada tradicional (LOOCV):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">CV(\mathbf{H})=\frac{1}{n}\sum_{i=1}^{n}
\left( Y(\mathbf{x}_{i}) - \hat{\mu}_{-i}(\mathbf{x}_{i}) \right)^{2},</annotation></semantics></math>
siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\mu}_{-i}(\mathbf{x}_{i})</annotation></semantics></math>
la estimaciÃ³n obtenida eliminando el dato
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-Ã©simo.</p></li>
<li><p>ValidaciÃ³n cruzada generalizada (Craven y Wahba, 1978):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mi>t</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ’</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">GCV(\mathbf{H})=\frac{1}{n}\sum_{i=1}^{n}
\left(  \frac{Y(\mathbf{x}_{i}) -\hat{\mu}(\mathbf{x}_{i})}
{1-\frac{1}{n}tr\left( \mathbf{S}\right) }\right)^{2}.</annotation></semantics></math></p></li>
</ul>
<p>Por ello se han propuesto distintos criterios alternativos para el
caso de datos dependientes:</p>
<ul>
<li><p>ValidaciÃ³n cruzada modificada (Chu and Marron, 1991):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">MCV(\mathbf{H})=\frac{1}{n}\sum_{i=1}^{n}\left(  Y(\mathbf{x}_{i})-\hat
{\mu}_{-N(i)}(\mathbf{x}_{i})\right)^{2},</annotation></semantics></math>
siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\mu}_{-i}(\mathbf{x}_{i})</annotation></semantics></math>
la estimaciÃ³n obtenida eliminando los datos en un vecindario
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(i)</annotation></semantics></math>
de
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ±</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_{i}</annotation></semantics></math>.</p></li>
<li><p>ValidaciÃ³n cruzada generalizada con correcciÃ³n de sesgo para
dependencia (Francisco-Fernandez and Opsomer, 2005):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mi>t</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ’</mi><mover><mi>ğ‘</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">CGCV(\mathbf{H})=\frac{1}{n}\sum_{i=1}^{n} \left(  
\frac{Y(\mathbf{x}_{i}) -\hat{\mu}(\mathbf{x}_{i})} {1 -
\frac{1}{n}tr\left( \mathbf{S} \hat{\mathbf{R}} \right) }\right)^{2},</annotation></semantics></math>
siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ‘</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\mathbf{R}}</annotation></semantics></math>
una estimaciÃ³n de la matriz de correlaciones.</p></li>
</ul>
<p>Adicionalmente, reescribiendo el criterio MCV de la forma:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ˜</mi><mo>âˆ’</mo><msub><mi>ğ’</mi><mrow><mi>âˆ’</mi><mi>N</mi></mrow></msub><mi>ğ˜</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ˜</mi><mo>âˆ’</mo><msub><mi>ğ’</mi><mrow><mi>âˆ’</mi><mi>N</mi></mrow></msub><mi>ğ˜</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">MCV(\mathbf{H}) = \frac{1}{n}  \left( \mathbf{Y}-\mathbf{S}_{-N} \mathbf{Y}\right) ^{t} \left( \mathbf{Y}-\mathbf{S}_{-N} \mathbf{Y} \right),</annotation></semantics></math>
donde
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">N = \left\lbrace  N(1),\ldots, N(n) \right\rbrace</annotation></semantics></math>,
puede verse que:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰ƒ</mo><mi>M</mi><mi>A</mi><mi>S</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo>âˆ’</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><mi>t</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ’</mi><mrow><mi>âˆ’</mi><mi>N</mi></mrow></msub><mi>ğšº</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathrm{E}\left( MCV(\mathbf{H})\right) \simeq MASE(\mathbf{H}) +
\sigma^{2} - \frac{2}{n}tr\left(\mathbf{S}_{-N}\boldsymbol{\Sigma}\right),</annotation></semantics></math>
siendo: <span class="math display">$$MASE(\mathbf{H})=
\frac{1}{n}\mathbb{E}\left( \left(
\mathbf{SY}-\boldsymbol{\mu}\right)^{t} \left(
\mathbf{SY}-\boldsymbol{\mu}\right) \right) = \\
=
\frac{1}{n}\left(\mathbf{S}\boldsymbol{\mu}-\boldsymbol{\mu}\right)^{t}
\left( \mathbf{S}\boldsymbol{\mu}-\boldsymbol{\mu}\right) +
\frac{1}{n}tr\left( \mathbf{S}\boldsymbol{\Sigma
}\mathbf{S}^{t}\right).$$</span></p>
<ul>
<li><p>ValidaciÃ³n cruzada modificada corregida (FernÃ¡ndez-Casal et al,
Preprint):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>M</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="false" form="prefix">(</mo><mrow><msub><mi>ğ±</mi><mi>ğ¢</mi></msub><mo stretchy="false" form="postfix" mathvariant="bold">)</mo></mrow></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><mi>t</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ’</mi><mrow><mi>âˆ’</mi><mi>N</mi></mrow></msub><mover><mi>ğšº</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">CMCV(\mathbf{H}) = \frac{1}{n}\sum_{i=1}^{n} \left( 
Y(\mathbf{x}_{i}) - \hat{\mu}_{-N(i)}{(\mathbf{x_i)}} \right)^{2} + 
\frac{2}{n}tr\left( \mathbf{S}_{-N} \hat{\boldsymbol{\Sigma}}\right).</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>C</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">CCV</annotation></semantics></math>
serÃ­a un caso particular tomando
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mi>â€¦</mi><mo>,</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ±</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">N = N_1 = \left\lbrace
\{\mathbf{x}_{1}\}, \ldots, \{\mathbf{x}_{n}\}\right\rbrace</annotation></semantics></math>.</p></li>
<li><p>Ventana por bootstrap suavizado: El criterio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>A</mi><mi>S</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‡</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">MASE(\mathbf{H})</annotation></semantics></math>
puede ser empleado cuando se conocen la media y varianzas teÃ³ricas (p.e.
en simulaciÃ³n), pero si se sustituyen por estimaciones, obtendrÃ­amos la
ventana Ã³ptima MASE de la correspondiente distribuciÃ³n
bootstrap.</p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#   Example:</span></span>
<span><span class="va">bin2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/binning.html">binning</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>     <span class="co"># sets nbin automatically</span></span>
<span><span class="fu"><a href="../../reference/h.cv.html">h.cv</a></span><span class="op">(</span><span class="va">bin2</span>, h.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span>                <span class="co"># MCV (ncv = 2)</span></span></code></pre></div>
<pre><code>$h
         [,1]   [,2]
[1,] 150.2659  0.000
[2,]   0.0000 82.392

$value
[1] 3.989047

$objective
[1] "CV"</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># cov.bin &lt;-  varcov(svm2, coords = coords(bin2))</span></span>
<span><span class="va">lp.h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/h.cv.html">h.cv</a></span><span class="op">(</span><span class="va">bin2</span>, cov.bin <span class="op">=</span> <span class="va">svm</span>, h.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="co"># CMCV (ncv = 2)</span></span>
<span><span class="va">lp.h</span></span></code></pre></div>
<pre><code>$h
         [,1]    [,2]
[1,] 403.1891   0.000
[2,]   0.0000 208.273

$value
[1] 5.925639

$objective
[1] "CV"</code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.15    0.03    1.28 </code></pre>
<p>Hay que tener cuidado con los algoritmos de optimizaciÃ³n automÃ¡ticos.
Por defecto se emplea el mÃ©todo â€œL-BFGS-Bâ€ de la funciÃ³n
<code>optim</code>. Como se trata de una minimizaciÃ³n no lineal
multidimensional puede haber problemas de mÃ­nimos locales. Para intentar
evitar este problema se puede establecer unos valores iniciales para los
parÃ¡metros de la ventana mediante el argumento <code>h.start</code>.
Alternativamente se puede establecer el parÃ¡metro
<code>DEalgorithm = TRUE</code> para utilizar el algoritmo genÃ©tico de
optimizaciÃ³n del paquete <code>DEoptim</code> (aunque puede aumentar
considerablemente el tiempo de computaciÃ³n).</p>
<p>Empleando la ventana seleccionada se podrÃ­a reestimar de nuevo la
tendencia, aunque tambiÃ©n habrÃ­a que volver a estimar el variograma (si
se modifica la variabilidad de gran escala, habrÃ­a que actualizar la
variabilidad de pequeÃ±a escala). Este procedimento se podrÃ­a repetir
iterativamente. Se tratarÃ¡ mÃ¡s adelante en la secciÃ³n â€œ<a href="Estimaci%C3%B3n%20conjunta%20(autom%C3%A1tica)">EstimaciÃ³n conjunta
(automÃ¡tica)</a>â€.</p>
</div>
<div class="section level3">
<h3 id="estimaciÃ³n-del-variograma-1">EstimaciÃ³n del variograma<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-variograma-1"></a>
</h3>
<p>La ventana para la estimaciÃ³n del variograma puede seleccionarse por
ejemplo minimizando el correspondiente error cuadrÃ¡tico de validaciÃ³n
cruzada:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>âˆ’</mo><mn>2</mn><msub><mover><mi>Î³</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">â€–</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">â€–</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">\sum\limits_{i=1}^{n-1}\sum\limits_{j=i+1}^{n}
\left( \left( \hat{\varepsilon}(\mathbf{x}_{i})
- \hat{\varepsilon}(\mathbf{x}_{j})\right)^{2}
- 2\hat{\gamma}_{-(i,j)}\left( \left\Vert \mathbf{x}_{i}
- \mathbf{x}_{j}\right\Vert \right) \right) ^{2},</annotation></semantics></math>
siendo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î³</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\gamma}_{-(i,j)}(\cdot )</annotation></semantics></math>
la estimaciÃ³n obtenida descartando
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">\left( \hat{\varepsilon}(\mathbf{x}_{i})
- \hat{\varepsilon}(\mathbf{x}_{j})\right) ^{2}</annotation></semantics></math>.
Sin embargo, para tener un mejor ajuste cerca del origen, suele ser
preferible emplear el error cuadrÃ¡tico relativo de validaciÃ³n cruzada:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Îµ</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msub><mover><mi>Î³</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>âˆ’</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">â€–</mo><msub><mi>ğ±</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>ğ±</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">â€–</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">\sum\limits_{i=1}^{n-1}\sum\limits_{j=i+1}^{n}\left( \frac{\left( \hat{
\varepsilon}(\mathbf{x}_{i})-\hat{\varepsilon}(\mathbf{x}_{j})\right) ^{2}
}{2\hat{\gamma}_{-(i,j)}\left( \left\Vert \mathbf{x}_{i}-\mathbf{x}
_{j}\right\Vert \right) }-1\right) ^{2}.</annotation></semantics></math>
Adicionalmente, si hay datos atÃ­picos, serÃ­a recomendable emplear un
error absoluto en lugar de cuadrÃ¡tico.</p>
<p>Ninguno de estos criterios tiene en cuenta la dependencia entre las
semivarianzas, por lo que las ventanas seleccionadas tenderÃ¡n a
infrasuavizar (especialmente en saltos grandes). Si se emplea un
procedimiento automÃ¡tico, puede ser recomendable incrementar la ventana
obtenida con estos criterios (en el algoritmo automÃ¡tico implementado en
<code>np.fitgeo</code> descrito a continuaciÃ³n, si no se especifica la
ventana para la estimaciÃ³n del variograma, se incrementa por defecto la
ventana obtenida con <code>h.cv</code> en un 50%).</p>
<p>NOTA: Actualmente sÃ³lo estÃ¡ implementada la estimaciÃ³n con ventana
global. En este caso, como las semivarianzas no son homocedÃ¡sticas,
serÃ­a preferible emplear ventanas locales.</p>
</div>
</div>
<div class="section level2">
<h2 id="estimaciÃ³n-conjunta-automÃ¡tica">EstimaciÃ³n conjunta (automÃ¡tica)<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-conjunta-autom%C3%A1tica"></a>
</h2>
<p>Como se comentÃ³ en la secciÃ³n anterior, para poder seleccionar una
ventana â€œÃ³ptimaâ€ para la estimaciÃ³n de la tendencia es necesario
disponer de una estimaciÃ³n del variograma. Sin embargo, la estimaciÃ³n de
la dependencia requiere de una estimaciÃ³n de la tendencia. Para resolver
este problema circular se puede emplear un algoritmo iterativo (similar
al mÃ©todo de estimaciÃ³n paramÃ©trica tradicional propuesto por Neuman y
Jacobson, 1984):</p>
<ol style="list-style-type: decimal">
<li><p>Seleccionar una ventana inicial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ‡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\mathbf{H}^{(0)}</annotation></semantics></math>
para
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\mu}</annotation></semantics></math>
(usando por ejemplo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>C</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">MCV</annotation></semantics></math>).</p></li>
<li><p>Para
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>â‰¥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k\geq 1</annotation></semantics></math>,
usando la ventana
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ‡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\mathbf{H}^{(k-1)}</annotation></semantics></math>
calcular
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><mi>ğ’</mi><mi>ğ˜</mi></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\mu}} = \mathbf{S}\mathbf{Y}</annotation></semantics></math>
y los correspondientes residuos
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ›†</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\varepsilon}}</annotation></semantics></math>.</p></li>
<li><p>Empleando el algoritmo para la correcciÃ³n de sesgo, obtener una
estimaciÃ³n piloto
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î³</mi><mo accent="true">Ìƒ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde{\gamma}(\cdot)</annotation></semantics></math>,
y ajustar un modelo S-B.</p></li>
<li><p>Construir
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>Î£</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\hat{\Sigma}^{(k)}</annotation></semantics></math>
y seleccionar una nueva ventana
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ‡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\mathbf{H}^{(k)}</annotation></semantics></math>
(empleando
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>M</mi><mi>C</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">CMCV</annotation></semantics></math>
o
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>G</mi><mi>C</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">CGCV</annotation></semantics></math>).</p></li>
<li><p>Repetir los pasos 2 al 4 hasta obtener convergencia.</p></li>
</ol>
<p>Este algoritmo estÃ¡ implementado en la funciÃ³n <a href="https://rubenfcasal.github.io/npsp/reference/np.fitgeo.html">np.fitgeo</a>
y normalmente dos iteraciones (el valor por defecto) son suficientes.
Por ejemplo, se podrÃ­a hacer un modelado automÃ¡tico ejecutando:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/np.fitgeo.html">np.fitgeo</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, svm.resid <span class="op">=</span> <span class="cn">TRUE</span>, h.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.24    0.06    1.08 </code></pre>
<p>El parÃ¡metro <code>iter</code> controla el nÃºmero mÃ¡ximo de
iteraciones del algoritmo completo. Estableciendo <code>iter = 0</code>
se emplea el variograma residual:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geom0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/np.fitgeo.html">np.fitgeo</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, iter <span class="op">=</span> <span class="fl">0</span>, h.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>La rutina devuelve el modelo no paramÃ©trico ajustado, un objeto <a href="https://rubenfcasal.github.io/npsp/reference/np.geo.html">np.geo</a>
que contiene las estimaciones de la tendencia y del variograma. Al
representarlo grÃ¡ficamente:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">geom</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/plot.np.fitgeo-1.png" width="864" style="display: block; margin: auto;">
AdemÃ¡s de las estimaciones finales de la tendencia y del variograma, se
muestra tambiÃ©n el variograma ajustado obtenido en la iteraciÃ³n anterior
(y si <code>svm.resid = TRUE</code> el variograma residual). Si no hay
grandes diferencias no habrÃ­a necesidad de seguir iterando, ya que el
criterio de selecciÃ³n de la ventana proporcionarÃ­a un suavizado
similar.</p>
</div>
<div class="section level2">
<h2 id="predicciÃ³n-kriging">PredicciÃ³n kriging<a class="anchor" aria-label="anchor" href="#predicci%C3%B3n-kriging"></a>
</h2>
<p>La funciÃ³n genÃ©rica <code>np.kriging</code> permite obtener
predicciones mediante kriging residual (combinando la estimaciÃ³n de la
tendencia con el kriging simple de los residuos). Actualmente solo estÃ¡
implementado kriging simple y kriging residual con vecindario global.
Para la resoluciÃ³n del sistema de ecuaciones kriging, a partir de la
factorizaciÃ³n de Choleski de la matriz de covarianzas, se emplea el
paquete <code>spam</code> para matrices dispersas.</p>
<p>Como ejemplo, compararemos las predicciones kriging obtenidas con el
ajuste automÃ¡tico con las correspondientes a la estimaciÃ³n con el
variograma residual.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">krig.grid0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/np.kriging.html">np.kriging</a></span><span class="op">(</span><span class="va">geom0</span>, ngrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">96</span>, <span class="fl">96</span><span class="op">)</span><span class="op">)</span> <span class="co"># 9216 predicciones</span></span>
<span><span class="va">krig.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/np.kriging.html">np.kriging</a></span><span class="op">(</span><span class="va">geom</span>, ngrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">96</span>, <span class="fl">96</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span>total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.58    0.05    2.53 </code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, omd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.9</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scale.range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">krig.grid0</span><span class="op">$</span><span class="va">trend</span>, <span class="va">krig.grid</span><span class="op">$</span><span class="va">trend</span>, finite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/simage.html">simage</a></span><span class="op">(</span> <span class="va">krig.grid0</span>, <span class="st">'trend'</span>, slim <span class="op">=</span> <span class="va">scale.range</span>, main <span class="op">=</span> <span class="st">'Trend estimates (residuals)'</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">jet.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/simage.html">simage</a></span><span class="op">(</span> <span class="va">krig.grid</span>, <span class="st">'trend'</span>, slim <span class="op">=</span> <span class="va">scale.range</span>, main <span class="op">=</span> <span class="st">'Trend estimates (iteration 2)'</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">jet.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/splot.html">splot</a></span><span class="op">(</span>slim <span class="op">=</span> <span class="va">scale.range</span>, col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">jet.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-9-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, omd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.9</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scale.range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">krig.grid0</span><span class="op">$</span><span class="va">kpred</span>, <span class="va">krig.grid</span><span class="op">$</span><span class="va">kpred</span>, finite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/simage.html">simage</a></span><span class="op">(</span> <span class="va">krig.grid0</span>, <span class="st">'kpred'</span>, slim <span class="op">=</span> <span class="va">scale.range</span>, main <span class="op">=</span> <span class="st">'Kriging predictions (residuals)'</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">jet.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/simage.html">simage</a></span><span class="op">(</span> <span class="va">krig.grid</span>, <span class="st">'kpred'</span>, slim <span class="op">=</span> <span class="va">scale.range</span>, main <span class="op">=</span> <span class="st">'Kriging predictions (iteration 2)'</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">jet.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/splot.html">splot</a></span><span class="op">(</span>slim <span class="op">=</span> <span class="va">scale.range</span>, col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">jet.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-9-2.png" width="864" style="display: block; margin: auto;"></p>
<p>Hay que tener en cuenta que se trata de un mÃ©todo robusto y no
depende demasiado del modelo de tendencia (la variabilidad no explicada
por la tendencia es capturada por la variabilidad de pequeÃ±a escala). En
este caso es de especial importancia la estimaciÃ³n del variograma cerca
del origen.</p>
<p>Sin embargo, si se comparan las varianzas kriging (o se emplean otros
mÃ©todos de inferencia, como por ejemplo bootstrap) puede haber grandes
diferencias entre los resultados obtenidos con distintos modelos.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, omd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.9</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scale.range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">krig.grid0</span><span class="op">$</span><span class="va">ksd</span>, <span class="va">krig.grid</span><span class="op">$</span><span class="va">ksd</span>, finite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/simage.html">simage</a></span><span class="op">(</span> <span class="va">krig.grid0</span>, <span class="st">'ksd'</span>, slim <span class="op">=</span> <span class="va">scale.range</span>, main <span class="op">=</span> <span class="st">'Kriging sd (residuals)'</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">hot.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">aquifer</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, cex <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/simage.html">simage</a></span><span class="op">(</span> <span class="va">krig.grid</span>, <span class="st">'ksd'</span>, slim <span class="op">=</span> <span class="va">scale.range</span>, main <span class="op">=</span> <span class="st">'Kriging sd (iteration 2)'</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">hot.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">aquifer</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, cex <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/splot.html">splot</a></span><span class="op">(</span>slim <span class="op">=</span> <span class="va">scale.range</span>, col <span class="op">=</span> <span class="fu"><a href="../../reference/splot.html">hot.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="aquifer_files/figure-html/unnamed-chunk-10-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cpu.time.html">cpu.time</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Time of last operation: 
   user  system elapsed 
   0.23    0.00    0.56 
Total time:
   user  system elapsed 
   1.30    0.14    6.82 </code></pre>
<div class="section level3">
<h3 id="futuras-implementaciones">Futuras implementaciones<a class="anchor" aria-label="anchor" href="#futuras-implementaciones"></a>
</h3>
<ul>
<li><p>Modelos anisotrÃ³picos de semivariograma (caso
espacio-temporal).</p></li>
<li><p>Modelos aditivos y parcialmente lineales.</p></li>
<li><p>Modelos dinÃ¡micos.</p></li>
<li><p>Kriging local.</p></li>
<li><p>â€¦</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="referencias">Referencias<a class="anchor" aria-label="anchor" href="#referencias"></a>
</h2>
<ul>
<li><p>Chu, C.K. and Marron, J.S. (1991) Comparison of Two Bandwidth
Selectors with Dependent Errors. <em>The Annals of Statistics</em>,
<strong>19</strong>, 1906-1918.</p></li>
<li><p>FernÃ¡ndez-Casal R., Castillo-PÃ¡ez S. and Francisco-FernÃ¡ndez M.
(2018), Nonparametric geostatistical risk mapping, <em>Stoch. Environ.
Res. Ris. Assess.</em>, <a href="https://doi.org/10.1007/s00477-017-1407-y" class="external-link">DOI</a>.</p></li>
<li><p>FernÃ¡ndez-Casal R., Castillo-PÃ¡ez S. and GarcÃ­a-SoidÃ¡n P. (2017),
Nonparametric estimation of the small-scale variability of
heteroscedastic spatial processes, <em>Spa. Sta.</em>,
<strong>22</strong>, 358-370, <a href="https://doi.org/10.1016/j.spasta.2017.04.001" class="external-link">DOI</a>.</p></li>
<li><p>Fernandez-Casal R. and Francisco-Fernandez M. (2014)
Nonparametric bias-corrected variogram estimation under non-constant
trend, <em>Stoch. Environ. Res. Ris. Assess.</em>, <strong>28</strong>,
1247-1259.</p></li>
<li><p>Fernandez-Casal R., Gonzalez-Manteiga W. and Febrero-Bande M.
(2003) Flexible Spatio-Temporal Stationary Variogram Models,
<em>Statistics and Computing</em>, <strong>13</strong>,
127-136.</p></li>
<li><p>Francisco-Fernandez M. and Opsomer J.D. (2005) Smoothing
parameter selection methods for nonparametric regression with spatially
correlated errors. <em>Canadian Journal of Statistics</em>, 33,
539-558.</p></li>
<li><p>Rupert D. and Wand M.P. (1994) Multivariate locally weighted
least squares regression. <em>The Annals of Statistics</em>,
<strong>22</strong>, 1346-1370.</p></li>
<li><p>Shapiro A. and Botha J.D. (1991) Variogram fitting with a general
class of conditionally non-negative definite functions.
<em>Computational Statistics and Data Analysis</em>,
<strong>11</strong>, 87-96.</p></li>
<li><p>Wand M.P. (1994) Fast Computation of Multivariate Kernel
Estimators. <em>Journal of Computational and Graphical Statistics</em>,
<strong>3</strong>, 433-445.</p></li>
<li><p>Wand M.P. and Jones M.C. (1995) <em>Kernel Smoothing</em>.
Chapman and Hall, London.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://rubenfcasal.github.io" class="external-link">Ruben Fernandez-Casal</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
