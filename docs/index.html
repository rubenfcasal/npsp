<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nonparametric Spatial Statistics • npsp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Nonparametric Spatial Statistics">
<meta property="og:description" content="Multidimensional nonparametric spatial (spatio-temporal) geostatistics.
    S3 classes and methods for multidimensional: linear binning,
    local polynomial kernel regression (spatial trend estimation), density and variogram estimation.
    Nonparametric methods for simultaneous inference on both spatial trend
    and variogram functions (for spatial processes).
    Nonparametric residual kriging (spatial prediction).
    For details on these methods see, for example, Fernandez-Casal and Francisco-Fernandez (2014) 
    &lt;doi:10.1007/s00477-013-0817-8&gt; or Castillo-Paez et al. (2019) &lt;doi:10.1016/j.csda.2019.01.017&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">npsp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7-11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/npsp.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/docs/aquifer.html">Geoestadistica no parametrica con el paquete *npsp*</a>
    </li>
    <li>
      <a href="articles/docs/Introduccion.html"> Introduccion a la Geoestadistica con R</a>
    </li>
    <li>
      <a href="articles/krigstat.html">Kriging with gstat</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rubenfcasal/npsp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="npsp-nonparametric-spatial-geostatistics">npsp: Nonparametric spatial (geo)statistics<a class="anchor" aria-label="anchor" href="#npsp-nonparametric-spatial-geostatistics"></a>
</h1></div>
<div class="section level3">
<h3 id="version-0710">Version 0.7.10<a class="anchor" aria-label="anchor" href="#version-0710"></a>
</h3>
<p>This package implements nonparametric methods for inference on multidimensional spatial (or spatio-temporal) processes, which may be (especially) useful in (automatic) geostatistical modeling and interpolation.</p>
</div>
<div class="section level2">
<h2 id="main-functions">Main functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<p>Nonparametric methods for inference on both spatial trend and variogram functions:</p>
<ul>
<li><p><code><a href="reference/np.fitgeo.html">np.fitgeo()</a></code> (automatically) fits an isotropic nonparametric geostatistical model by estimating the trend and the variogram (using a bias-corrected estimator) iteratively (by calling <code><a href="reference/h.cv.html">h.cv()</a></code>, <code><a href="reference/locpol.html">locpol()</a></code>, <code><a href="reference/np.svar.html">np.svariso.corr()</a></code> and <code><a href="reference/fitsvar.sb.iso.html">fitsvar.sb.iso()</a></code> at each iteration).</p></li>
<li><p><code><a href="reference/locpol.html">locpol()</a></code>, <code><a href="reference/np.den.html">np.den()</a></code> and <code><a href="reference/np.svar.html">np.svar()</a></code> use local polynomial kernel smoothing to compute nonparametric estimates of a multidimensional regression function (e.g. a spatial trend), a probability density function or a semivariogram (or their first derivatives), respectively. Estimates of these functions can be constructed for any dimension (depending on the amount of available memory).</p></li>
<li><p><code><a href="reference/np.svar.html">np.svariso.corr()</a></code> computes a bias-corrected nonparametric semivariogram estimate using an iterative algorithm similar to that described in Fernandez-Casal and Francisco-Fernandez (2014). This procedure tries to correct the bias due to the direct use of residuals (obtained, in this case, from a nonparametric estimation of the trend function) in semivariogram estimation.</p></li>
<li><p><code><a href="reference/fitsvar.sb.iso.html">fitsvar.sb.iso()</a></code> fits a ‘nonparametric’ isotropic Shapiro-Botha variogram model by WLS. Currently, only isotropic semivariogram estimation is supported.</p></li>
</ul>
<p>Nonparametric residual kriging (sometimes called external drift kriging):</p>
<ul>
<li><p><code><a href="reference/np.kriging.html">np.kriging()</a></code> computes residual kriging predictions<br>
(and the corresponding simple kriging standard errors).</p></li>
<li><p><code><a href="reference/np.kriging.html">kriging.simple()</a></code> computes simple kriging predictions and standard errors.</p></li>
<li><p>Currently, only global (residual) simple kriging is implemented.<br>
Users are encouraged to use <code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::krige()</a></code> (or <code><a href="https://rdrr.io/pkg/gstat/man/krige.cv.html" class="external-link">gstat::krige.cv()</a></code>) together with <code><a href="reference/npsp-gstat.html">as.vgm()</a></code> for local kriging.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="other-functions">Other functions<a class="anchor" aria-label="anchor" href="#other-functions"></a>
</h2>
<p>Among the other functions intended for direct access by the user, the following (methods for multidimensional linear binning, local polynomial kernel regression, density or variogram estimation) could be emphasized: <code><a href="reference/binning.html">binning()</a></code>, <code><a href="reference/bin.den.html">bin.den()</a></code>, <code><a href="reference/svar.bin.html">svar.bin()</a></code>, <code><a href="reference/h.cv.html">h.cv()</a></code> and <code><a href="reference/interp.html">interp()</a></code>. There are functions for plotting data joint with a legend representing a continuous color scale (based on <code><a href="https://rdrr.io/pkg/fields/man/image.plot.html" class="external-link">fields::image.plot()</a></code>):</p>
<ul>
<li><p><code><a href="reference/splot.html">splot()</a></code> allows to combine a standard R plot with a legend.</p></li>
<li><p><code><a href="reference/spoints.html">spoints()</a></code>, <code><a href="reference/simage.html">simage()</a></code> and <code><a href="reference/spersp.html">spersp()</a></code> draw the corresponding high-level plot with a legend strip for the color scale.</p></li>
</ul>
<p>There are also some functions which can be used to interact with other packages. For instance, <code><a href="reference/npsp-geoR.html">as.variogram()</a></code> (geoR) or <code><a href="reference/npsp-gstat.html">as.vgm()</a></code> (gstat).</p>
<p>See the <a href="https://rubenfcasal.github.io/npsp/reference/index.html" class="external-link">Reference</a> for the complete list of functions.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><code>npsp</code> is available from CRAN, but you can install the development version from github with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rubenfcasal/npsp"</span><span class="op">)</span></span></code></pre></div>
<p>Note also that, as this package requires compilation, Windows users need to have previously installed the appropriate version of <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a>, and OS X users need to have installed <a href="https://apps.apple.com/us/app/xcode/id497799835" class="external-link">Xcode</a>.</p>
<p>Alternatively, Windows users may install the corresponding <em>npsp_X.Y.Z.zip</em> file in the <a href="https://github.com/rubenfcasal/npsp/releases/latest" class="external-link">releases section</a> of the github repository.</p>
</div>
<div class="section level2">
<h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a>
</h2>
<p><a href="https://rubenfcasal.github.io" class="external-link">Ruben Fernandez-Casal</a> (Dep. Mathematics, University of A Coruña, Spain). Please send comments, error reports or suggestions to <a href="mailto:rubenfcasal@gmail.com" class="email">rubenfcasal@gmail.com</a>.</p>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>Important suggestions and contributions to some techniques included here were made by Sergio Castillo-Páez (Universidad de las Fuerzas Armadas ESPE, Ecuador) and Tomas Cotos-Yañez (Dep. Statistics, University of Vigo, Spain).</p>
<p>This research has been supported by MINECO grant MTM2017-82724-R, and by the Xunta de Galicia (Grupos de Referencia Competitiva ED431C-2020-14 and Centro de Investigación del Sistema universitario de Galicia ED431G 2019/01), all of them through the ERDF.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Castillo-Páez S., Fernández-Casal R. and García-Soidán P. (2019), A nonparametric bootstrap method for spatial data, <strong>137</strong>, <em>Comput. Stat. Data Anal.</em>, 1-15, <a href="https://doi.org/10.1016/j.csda.2019.01.017" class="external-link">DOI</a>.</p></li>
<li><p>Fernández-Casal R., Castillo-Páez S. and Francisco-Fernández M. (2018), Nonparametric geostatistical risk mapping, <em>Stoch. Environ. Res. Ris. Assess.</em>, <strong>32</strong>, 675-684, <a href="https://doi.org/10.1007/s00477-017-1407-y" class="external-link">DOI</a>.</p></li>
<li><p>Fernández-Casal R., Castillo-Páez S. and García-Soidán P. (2017), Nonparametric estimation of the small-scale variability of heteroscedastic spatial processes, <em>Spa. Sta.</em>, <strong>22</strong>, 358-370, <a href="https://doi.org/10.1016/j.spasta.2017.04.001" class="external-link">DOI</a>.</p></li>
<li><p>Fernandez-Casal R. and Francisco-Fernandez M. (2014) Nonparametric bias-corrected variogram estimation under non-constant trend, <em>Stoch. Environ. Res. Ris. Assess.</em>, <strong>28</strong>, 1247-1259, <a href="https://doi.org/10.1007/s00477-013-0817-8" class="external-link">DOI</a>.</p></li>
<li><p>Fernandez-Casal R., Gonzalez-Manteiga W. and Febrero-Bande M. (2003) Flexible Spatio-Temporal Stationary Variogram Models, <em>Statistics and Computing</em>, <strong>13</strong>, 127-136, <a href="https://doi.org/10.1023/A:1023204525046" class="external-link">DOI</a>.</p></li>
<li><p>Rupert D. and Wand M.P. (1994) Multivariate locally weighted least squares regression. <em>The Annals of Statistics</em>, <strong>22</strong>, 1346-1370.</p></li>
<li><p>Shapiro A. and Botha J.D. (1991) Variogram fitting with a general class of conditionally non-negative definite functions. <em>Computational Statistics and Data Analysis</em>, <strong>11</strong>, 87-96.</p></li>
<li><p>Wand M.P. (1994) Fast Computation of Multivariate Kernel Estimators. <em>Journal of Computational and Graphical Statistics</em>, <strong>3</strong>, 433-445.</p></li>
<li><p>Wand M.P. and Jones M.C. (1995) <em>Kernel Smoothing</em>. Chapman and Hall, London.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=npsp" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/rubenfcasal/npsp/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/rubenfcasal/npsp/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing npsp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://rubenfcasal.github.io" class="external-link">Ruben Fernandez-Casal</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-5785-3739" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://rubenfcasal.github.io" class="external-link">Ruben Fernandez-Casal</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
