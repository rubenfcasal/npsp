<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Utilities for plotting with a color scale — splot • npsp</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Utilities for plotting with a color scale — splot" />

<meta property="og:description" content="splot is designed to combine a standard R plot with 
a legend representing a (continuous) color scale. This is done by splitting 
the plotting region into two parts. Keeping one for the main chart and 
putting the legend in the other.
sxxxx functions (spoints, simage 
and spersp) draw the corresponding high-level plot (xxxx) 
with a legend strip for the color scale.
These functions are based on function image.plot of package
fields, see its documentation for additional information.
jet.colors and hot.colors create a color table useful for contiguous 
color scales and scolor assigns colors to a numerical vector." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">npsp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/npsp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/docs/aquifer.html">Geoestadistica no parametrica con el paquete *npsp*</a>
    </li>
    <li>
      <a href="../articles/docs/Introduccion.html"> Introduccion a la Geoestadistica con R</a>
    </li>
    <li>
      <a href="../articles/krigstat.html">Kriging with gstat</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rubenfcasal/npsp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Utilities for plotting with a color scale</h1>
    <small class="dont-index">Source: <a href='https://github.com/rubenfcasal/npsp/blob/master/R/splot.R'><code>R/splot.R</code></a></small>
    <div class="hidden name"><code>splot.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>splot</code> is designed to combine a standard R plot with 
a legend representing a (continuous) color scale. This is done by splitting 
the plotting region into two parts. Keeping one for the main chart and 
putting the legend in the other.</p>
<p><code>sxxxx</code> functions (<code><a href='spoints.html'>spoints</a></code>, <code><a href='simage.html'>simage</a></code> 
and <code><a href='spersp.html'>spersp</a></code>) draw the corresponding high-level plot (<code>xxxx</code>) 
with a legend strip for the color scale.</p>
<p>These functions are based on function <code><a href='https://www.rdocumentation.org/packages/fields/topics/image.plot'>image.plot</a></code> of package
<span class="pkg">fields</span>, see its documentation for additional information.</p>
<p><code>jet.colors</code> and <code>hot.colors</code> create a color table useful for contiguous 
color scales and <code>scolor</code> assigns colors to a numerical vector.</p>
    
    </div>

    <pre class="usage"><span class='fu'>splot</span>(<span class='kw'>slim</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>jet.colors</span>(<span class='fl'>128</span>), <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>horizontal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>legend.shrink</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>legend.width</span> <span class='kw'>=</span> <span class='fl'>1.2</span>,
  <span class='kw'>legend.mar</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/ifelse'>ifelse</a></span>(<span class='no'>horizontal</span>, <span class='fl'>3.1</span>, <span class='fl'>5.1</span>), <span class='kw'>legend.lab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>bigplot</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>smallplot</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>lab.breaks</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>axis.args</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>legend.args</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>scolor</span>(<span class='no'>s</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>jet.colors</span>(<span class='fl'>128</span>), <span class='kw'>slim</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/range'>range</a></span>(<span class='no'>s</span>, <span class='kw'>finite</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))

<span class='fu'>jet.colors</span>(<span class='no'>n</span>)

<span class='fu'>hot.colors</span>(<span class='no'>n</span>, <span class='kw'>rev</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>slim</th>
      <td><p>limits used to set up the color scale.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>color table used to set up the color scale (see <code><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></code> for
details).</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>(optional) numeric vector with the breakpoints for the color scale: 
must have one more breakpoint than <code>col</code> and be in increasing order.</p></td>
    </tr>
    <tr>
      <th>horizontal</th>
      <td><p>logical; if <code>FALSE</code> (default) legend will be a vertical strip on the
right side. If <code>TRUE</code> the legend strip will be along the bottom.</p></td>
    </tr>
    <tr>
      <th>legend.shrink</th>
      <td><p>amount to shrink the size of legend relative to the
full height or width of the plot.</p></td>
    </tr>
    <tr>
      <th>legend.width</th>
      <td><p>width in characters of the legend strip. Default is
1.2, a little bigger that the width of a character.</p></td>
    </tr>
    <tr>
      <th>legend.mar</th>
      <td><p>width in characters of legend margin that has the axis.
Default is 5.1 for a vertical legend and 3.1 for a horizontal legend.</p></td>
    </tr>
    <tr>
      <th>legend.lab</th>
      <td><p>label for the axis of the color legend. Default is no
label as this is usual evident from the plot title.</p></td>
    </tr>
    <tr>
      <th>bigplot</th>
      <td><p>plot coordinates for main plot. If not passed these will be 
determined within the function.</p></td>
    </tr>
    <tr>
      <th>smallplot</th>
      <td><p>plot coordinates for legend strip. If not passed these
will be determined within the function.</p></td>
    </tr>
    <tr>
      <th>lab.breaks</th>
      <td><p>if breaks are supplied these are text string labels to
put at each break value. This is intended to label axis on a transformed
scale such as logs.</p></td>
    </tr>
    <tr>
      <th>axis.args</th>
      <td><p>additional arguments for the axis function used to create
the legend axis (see <code><a href='https://www.rdocumentation.org/packages/fields/topics/image.plot'>image.plot</a></code> for details).</p></td>
    </tr>
    <tr>
      <th>legend.args</th>
      <td><p>arguments for a complete specification of the legend
label. This is in the form of list and is just passed to the <code><a href='https://www.rdocumentation.org/packages/graphics/topics/mtext'>mtext</a></code>
function. Usually this will not be needed (see <code><a href='https://www.rdocumentation.org/packages/fields/topics/image.plot'>image.plot</a></code> 
for details).</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>logical; if <code>TRUE</code> the legend strip is just added 
to the existing plot.</p></td>
    </tr>
    <tr>
      <th>s</th>
      <td><p>values to be converted to the color scale.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of colors (<code>&gt;= 1</code>) to be in the palette.</p></td>
    </tr>
    <tr>
      <th>rev</th>
      <td><p>logical; if <code>TRUE</code>, the palette is reversed (decreasing overall luminosity).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>splot</code> invisibly returns a list with the following 3 components:</p>
<dt>bigplot</dt><dd><p>plot coordinates of the main plot. These values may be useful for 
drawing a plot without the legend that is the same size as the plots with legends.</p></dd>
<dt>smallplot</dt><dd><p>plot coordinates of the secondary plot (legend strip).</p></dd>
<dt>old.par</dt><dd><p>previous graphical parameters (<code><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par(old.par)</a></code> 
will reset plot parameters to the values before entering the function).</p></dd>

jet.colors and hot.colors return a character vector of colors (similar to 
<a href='https://www.rdocumentation.org/packages/grDevices/topics/palettes'>heat.colors</a> or <a href='https://www.rdocumentation.org/packages/grDevices/topics/palettes'>terrain.colors</a>; see <a href='https://www.rdocumentation.org/packages/grDevices/topics/rgb'>rgb</a>).

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>scolor</code> converts a real valued vector to a color scale. The range 
<code>slim</code> is divided into <code>length(col) + 1</code> pieces of equal length.
Values which fall outside the range of the scale are coded as <code>NA</code>.</p>
<p><code>jet.colors</code> generates a rainbow style color table similar to the MATLAB (TM) 
jet color scheme. It may be appropriate to distinguish between values above and 
below a central value (e.g. between positive and negative values).</p>
<p><code>hot.colors</code> generates a color table similar to the MATLAB (TM) 
hot color scheme (reversed by default). It may be appropriate to represent values  
ranging from 0 to some maximum level (e.g. density estimation). 
The default value <code>rev = TRUE</code> may be adecuate to grayscale convertion.</p>
    
    <h2 class="hasAnchor" id="side-effects"><a class="anchor" href="#side-effects"></a>Side Effects</h2>

    <p>After exiting, the plotting region may be changed 
(<code><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a>("plt")</code>) to make it possible to add more features to the plot.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='spoints.html'>spoints</a></code>, <code><a href='simage.html'>simage</a></code>, <code><a href='spersp.html'>spersp</a></code>, 
<code><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></code>, <code><a href='https://www.rdocumentation.org/packages/fields/topics/image.plot'>image.plot</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>scale.range</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/range'>range</a></span>(<span class='no'>aquifer</span>$<span class='no'>head</span>)
<span class='fu'>splot</span>(<span class='kw'>slim</span> <span class='kw'>=</span> <span class='no'>scale.range</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/with'>with</a></span>( <span class='no'>aquifer</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>scolor</span>(<span class='no'>head</span>, <span class='kw'>slim</span> <span class='kw'>=</span> <span class='no'>scale.range</span>),
       <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Wolfcamp aquifer data"</span>))</div><div class='img'><img src='splot-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># equivalent to:</span>
<span class='co'># with( aquifer, spoints(lon, lat, head, main = "Wolfcamp aquifer data"))</span>

<span class='co'>#</span>
<span class='co'># Multiple plots with a common legend:</span>
<span class='co'>#</span>
<span class='co'># regularly spaced 2D data...</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>nx</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>40</span>, <span class='fl'>40</span>) <span class='co'># ndata =  prod(nx)</span>
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(-<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='no'>nx</span>[<span class='fl'>1</span>])
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(-<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='no'>nx</span>[<span class='fl'>2</span>])
<span class='no'>trend</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/outer'>outer</a></span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>y</span>) <span class='no'>x</span>^<span class='fl'>2</span> - <span class='no'>y</span>^<span class='fl'>2</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>trend</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/prod'>prod</a></span>(<span class='no'>nx</span>), <span class='fl'>0</span>, <span class='fl'>0.1</span>)
<span class='no'>scale.range</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>1.2</span>, <span class='fl'>1.2</span>)
<span class='no'>scale.color</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/palettes'>heat.colors</a></span>(<span class='fl'>64</span>)
<span class='co'># 1x2 plot with some room for the legend...</span>
<span class='no'>old.par</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='kw'>omd</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.85</span>, <span class='fl'>0.05</span>, <span class='fl'>0.95</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>( <span class='no'>x1</span>, <span class='no'>x2</span>, <span class='no'>trend</span>, <span class='kw'>zlim</span> <span class='kw'>=</span> <span class='no'>scale.range</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>'Trend'</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>scale.color</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>( <span class='no'>x1</span>, <span class='no'>x2</span>, <span class='no'>y</span>, <span class='kw'>zlim</span> <span class='kw'>=</span> <span class='no'>scale.range</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>'Data'</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>scale.color</span>)</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='no'>old.par</span>)
<span class='co'># the legend can be added to any plot...</span>
<span class='fu'>splot</span>(<span class='kw'>slim</span> <span class='kw'>=</span> <span class='no'>scale.range</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>scale.color</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='splot-2.png' alt='' width='700' height='433' /></div><div class='input'>## note that argument 'zlim' in 'image' corresponds with 'slim' in 'sxxxx' functions. 
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#side-effects">Side Effects</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Based on <code><a href='https://www.rdocumentation.org/packages/fields/topics/image.plot'>image.plot</a></code> function from package <span class="pkg">fields</span>:
fields, Tools for spatial data. 
Copyright 2004-2013, Institute for Mathematics Applied Geosciences. 
University Corporation for Atmospheric Research.</p>
<p>Modified by Ruben Fernandez-Casal &lt;rubenfcasal@gmail.com&gt;.</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://rubenfcasal.github.io'>Ruben Fernandez-Casal</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

